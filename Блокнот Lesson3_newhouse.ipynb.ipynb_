{"cells":[{"cell_type":"code","execution_count":null,"metadata":{"id":"qgn8rkAMuVdr"},"outputs":[],"source":["#Задание\n","#Собрать информацию о всех строящихся объектах на сайте \"наш.дом.рф\"\n","#Cохранить ее в pandas dataframe\n","#Cохранить pandas dataframe в pickle\n","#Cохранить pandas dataframe в excel\n","#Cохранить pandas dataframe в БД"]},{"cell_type":"code","execution_count":28,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":7211,"status":"ok","timestamp":1721921374400,"user":{"displayName":"Алена Щелкунова","userId":"02876905872959079261"},"user_tz":-180},"id":"9hbgZ0xRugeo","outputId":"4415b548-1169-43a5-b959-18a2ee93ee05"},"outputs":[{"output_type":"stream","name":"stdout","text":["Collecting git+https://github.com/lenarsaitov/cianparser.git\n","  Cloning https://github.com/lenarsaitov/cianparser.git to /tmp/pip-req-build-q1dktt9w\n","  Running command git clone --filter=blob:none --quiet https://github.com/lenarsaitov/cianparser.git /tmp/pip-req-build-q1dktt9w\n","  Resolved https://github.com/lenarsaitov/cianparser.git to commit 236352a200b08b27c24d14b18939b4c34691cbb2\n","  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\n","Requirement already satisfied: cloudscraper in /usr/local/lib/python3.10/dist-packages (from cianparser==1.0.4) (1.2.71)\n","Requirement already satisfied: beautifulsoup4 in /usr/local/lib/python3.10/dist-packages (from cianparser==1.0.4) (4.12.3)\n","Requirement already satisfied: transliterate in /usr/local/lib/python3.10/dist-packages (from cianparser==1.0.4) (1.10.2)\n","Requirement already satisfied: lxml in /usr/local/lib/python3.10/dist-packages (from cianparser==1.0.4) (4.9.4)\n","Requirement already satisfied: datetime in /usr/local/lib/python3.10/dist-packages (from cianparser==1.0.4) (5.5)\n","Requirement already satisfied: soupsieve>1.2 in /usr/local/lib/python3.10/dist-packages (from beautifulsoup4->cianparser==1.0.4) (2.5)\n","Requirement already satisfied: pyparsing>=2.4.7 in /usr/local/lib/python3.10/dist-packages (from cloudscraper->cianparser==1.0.4) (3.1.2)\n","Requirement already satisfied: requests>=2.9.2 in /usr/local/lib/python3.10/dist-packages (from cloudscraper->cianparser==1.0.4) (2.31.0)\n","Requirement already satisfied: requests-toolbelt>=0.9.1 in /usr/local/lib/python3.10/dist-packages (from cloudscraper->cianparser==1.0.4) (1.0.0)\n","Requirement already satisfied: zope.interface in /usr/local/lib/python3.10/dist-packages (from datetime->cianparser==1.0.4) (6.4.post2)\n","Requirement already satisfied: pytz in /usr/local/lib/python3.10/dist-packages (from datetime->cianparser==1.0.4) (2023.4)\n","Requirement already satisfied: six>=1.1.0 in /usr/local/lib/python3.10/dist-packages (from transliterate->cianparser==1.0.4) (1.16.0)\n","Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.10/dist-packages (from requests>=2.9.2->cloudscraper->cianparser==1.0.4) (3.3.2)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests>=2.9.2->cloudscraper->cianparser==1.0.4) (3.7)\n","Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests>=2.9.2->cloudscraper->cianparser==1.0.4) (2.0.7)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests>=2.9.2->cloudscraper->cianparser==1.0.4) (2024.7.4)\n","Requirement already satisfied: setuptools in /usr/local/lib/python3.10/dist-packages (from zope.interface->datetime->cianparser==1.0.4) (71.0.4)\n"]}],"source":["!pip install git+https://github.com/lenarsaitov/cianparser.git"]},{"cell_type":"code","execution_count":30,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"CSVK1d6Yuw0Y","outputId":"074f306e-0ef0-4d43-e0bc-9afe97fa7f85","executionInfo":{"status":"ok","timestamp":1721921676244,"user_tz":-180,"elapsed":266612,"user":{"displayName":"Алена Щелкунова","userId":"02876905872959079261"}}},"outputs":[{"output_type":"stream","name":"stdout","text":["\n","                              Preparing to collect information from pages..\n","The absolute path to the file: \n","/content/cian_flat_sale_1_30_moskva_25_Jul_2024_15_30_10_087152.csv \n","\n","The page from which the collection of information begins: \n"," https://cian.ru/cat.php?engine_version=2&p=1&with_neighbors=0&region=1&deal_type=sale&offer_type=flat&room1=1&room2=1&object_type%5B0%5D=2\n","\n","Collecting information from pages with list of offers\n","\n","\n","\n","\n","\n","\n","\n","\n","\n","\n","\n","\n","\n","\n","\n","\n","\n","\n","\n","\n","\n","\n","\n","\n","\n","\n","\n","\n","\n","\n","\n","The collection of information from the pages with list of offers is completed\n","Total number of parsed offers: 801. \n","{'author': 'VESPER', 'author_type': 'developer', 'url': 'https://www.cian.ru/sale/flat/262519758/', 'location': 'Москва', 'deal_type': 'sale', 'accommodation_type': 'flat', 'floor': 5, 'floors_count': 21, 'rooms_count': 2, 'total_meters': 110.6, 'price': 103787040, 'district': 'Пресненский', 'street': ' Костикова', 'house_number': '4к1', 'underground': 'Улица 1905 года', 'residential_complex': 'Lucky'}\n"]}],"source":["import cianparser\n","\n","moscow_parser = cianparser.CianParser(location=\"Москва\")\n","piter_parser = cianparser.CianParser(location=\"Санкт-Петербург\")\n","sochi_perser = cianparser.CianParser(location=\"Сочи\")\n","yakutsk_perser = cianparser.CianParser(location=\"Якутск\")\n","sochi_perser = cianparser.CianParser(location=\"Сочи\")\n","tumen_perser = cianparser.CianParser(location=\"Тюмень\")\n","data = moscow_parser.get_flats(deal_type=\"sale\", rooms=(1, 2), with_saving_csv=True, additional_settings={\"start_page\":1, \"end_page\":30,\"object_type\":\"new\"})\n","\n","print(data[0])\n"]},{"cell_type":"code","source":["import pandas as pd"],"metadata":{"id":"3WF9jNRSTzxj","executionInfo":{"status":"ok","timestamp":1721921713569,"user_tz":-180,"elapsed":430,"user":{"displayName":"Алена Щелкунова","userId":"02876905872959079261"}}},"execution_count":31,"outputs":[]},{"cell_type":"code","source":["!pip install openpyxl"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"EZavq0cFT-Ib","executionInfo":{"status":"ok","timestamp":1721921718814,"user_tz":-180,"elapsed":3810,"user":{"displayName":"Алена Щелкунова","userId":"02876905872959079261"}},"outputId":"4e48544e-ef95-40f2-abce-db5e600fbe04"},"execution_count":32,"outputs":[{"output_type":"stream","name":"stdout","text":["Requirement already satisfied: openpyxl in /usr/local/lib/python3.10/dist-packages (3.1.5)\n","Requirement already satisfied: et-xmlfile in /usr/local/lib/python3.10/dist-packages (from openpyxl) (1.1.0)\n"]}]},{"cell_type":"code","source":["df=pd.DataFrame(data)"],"metadata":{"id":"ZQd1Det-UHJL","executionInfo":{"status":"ok","timestamp":1721921720544,"user_tz":-180,"elapsed":418,"user":{"displayName":"Алена Щелкунова","userId":"02876905872959079261"}}},"execution_count":33,"outputs":[]},{"cell_type":"code","source":["pd.DataFrame(data)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"id":"DDbqgsgIVRav","executionInfo":{"status":"ok","timestamp":1721921723547,"user_tz":-180,"elapsed":422,"user":{"displayName":"Алена Щелкунова","userId":"02876905872959079261"}},"outputId":"0c77cbb2-3c24-41f3-f2ee-1d696de359e1"},"execution_count":34,"outputs":[{"output_type":"execute_result","data":{"text/plain":["           author author_type                                       url  \\\n","0          VESPER   developer  https://www.cian.ru/sale/flat/262519758/   \n","1    ID 118500316   homeowner  https://www.cian.ru/sale/flat/304242702/   \n","2           FORMA   developer  https://www.cian.ru/sale/flat/303018405/   \n","3    ID 112591621   homeowner  https://www.cian.ru/sale/flat/301839935/   \n","4       Главстрой   developer  https://www.cian.ru/sale/flat/296921092/   \n","..            ...         ...                                       ...   \n","796                            https://www.cian.ru/sale/flat/305093267/   \n","797                            https://www.cian.ru/sale/flat/302666659/   \n","798                            https://www.cian.ru/sale/flat/302666665/   \n","799                            https://www.cian.ru/sale/flat/302667378/   \n","800                            https://www.cian.ru/sale/flat/302666963/   \n","\n","    location deal_type accommodation_type  floor  floors_count  rooms_count  \\\n","0     Москва      sale               flat      5            21            2   \n","1     Москва      sale               flat     19            41            2   \n","2     Москва      sale               flat     18            33            2   \n","3     Москва      sale               flat     13            45            2   \n","4     Москва      sale               flat      2            18            2   \n","..       ...       ...                ...    ...           ...          ...   \n","796   Москва      sale               flat      5            14            1   \n","797   Москва      sale               flat      9            10            1   \n","798   Москва      sale               flat      9            10            1   \n","799   Москва      sale               flat      4             9            1   \n","800   Москва      sale               flat      2            10            1   \n","\n","     total_meters        price        district                 street  \\\n","0          110.60  103787040.0     Пресненский              Костикова   \n","1           55.00   28500000.0         Раменки  1-й Сетуньский проезд   \n","2           46.45   41753905.0     Пресненский                   к2.3   \n","3           51.00   31000000.0    Дорогомилово     Кутузовский проезд   \n","4           74.60   30350099.0  Филевский парк       Береговой проезд   \n","..            ...          ...             ...                    ...   \n","796         34.30    9078206.0                            Аэростатная   \n","797         38.79    9007090.0                                          \n","798         38.09    9082782.0                                          \n","799         41.47    9031284.0                                          \n","800         34.36    9062840.0                                          \n","\n","    house_number         underground     residential_complex  \n","0            4к1     Улица 1905 года                   Lucky  \n","1            вл6         Кутузовская                    Hide  \n","2           к2.3         Белорусская             Репаблик ЖК  \n","3          16А/1       Деловой центр  River Park Кутузовский  \n","4              2  Народное Ополчение             Береговой-2  \n","..           ...                 ...                     ...  \n","796          6к4           Кокошкино           Новое Внуково  \n","797          к32           Кокошкино        Новое Внуково ЖК  \n","798          к32           Кокошкино        Новое Внуково ЖК  \n","799          к28         Рассказовка        Новое Внуково ЖК  \n","800          к21              Санино        Новое Внуково ЖК  \n","\n","[801 rows x 16 columns]"],"text/html":["\n","  <div id=\"df-fb4830c3-bc9e-4e9b-83b0-9dc56e60b532\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>author</th>\n","      <th>author_type</th>\n","      <th>url</th>\n","      <th>location</th>\n","      <th>deal_type</th>\n","      <th>accommodation_type</th>\n","      <th>floor</th>\n","      <th>floors_count</th>\n","      <th>rooms_count</th>\n","      <th>total_meters</th>\n","      <th>price</th>\n","      <th>district</th>\n","      <th>street</th>\n","      <th>house_number</th>\n","      <th>underground</th>\n","      <th>residential_complex</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>VESPER</td>\n","      <td>developer</td>\n","      <td>https://www.cian.ru/sale/flat/262519758/</td>\n","      <td>Москва</td>\n","      <td>sale</td>\n","      <td>flat</td>\n","      <td>5</td>\n","      <td>21</td>\n","      <td>2</td>\n","      <td>110.60</td>\n","      <td>103787040.0</td>\n","      <td>Пресненский</td>\n","      <td>Костикова</td>\n","      <td>4к1</td>\n","      <td>Улица 1905 года</td>\n","      <td>Lucky</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>ID 118500316</td>\n","      <td>homeowner</td>\n","      <td>https://www.cian.ru/sale/flat/304242702/</td>\n","      <td>Москва</td>\n","      <td>sale</td>\n","      <td>flat</td>\n","      <td>19</td>\n","      <td>41</td>\n","      <td>2</td>\n","      <td>55.00</td>\n","      <td>28500000.0</td>\n","      <td>Раменки</td>\n","      <td>1-й Сетуньский проезд</td>\n","      <td>вл6</td>\n","      <td>Кутузовская</td>\n","      <td>Hide</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>FORMA</td>\n","      <td>developer</td>\n","      <td>https://www.cian.ru/sale/flat/303018405/</td>\n","      <td>Москва</td>\n","      <td>sale</td>\n","      <td>flat</td>\n","      <td>18</td>\n","      <td>33</td>\n","      <td>2</td>\n","      <td>46.45</td>\n","      <td>41753905.0</td>\n","      <td>Пресненский</td>\n","      <td>к2.3</td>\n","      <td>к2.3</td>\n","      <td>Белорусская</td>\n","      <td>Репаблик ЖК</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>ID 112591621</td>\n","      <td>homeowner</td>\n","      <td>https://www.cian.ru/sale/flat/301839935/</td>\n","      <td>Москва</td>\n","      <td>sale</td>\n","      <td>flat</td>\n","      <td>13</td>\n","      <td>45</td>\n","      <td>2</td>\n","      <td>51.00</td>\n","      <td>31000000.0</td>\n","      <td>Дорогомилово</td>\n","      <td>Кутузовский проезд</td>\n","      <td>16А/1</td>\n","      <td>Деловой центр</td>\n","      <td>River Park Кутузовский</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>Главстрой</td>\n","      <td>developer</td>\n","      <td>https://www.cian.ru/sale/flat/296921092/</td>\n","      <td>Москва</td>\n","      <td>sale</td>\n","      <td>flat</td>\n","      <td>2</td>\n","      <td>18</td>\n","      <td>2</td>\n","      <td>74.60</td>\n","      <td>30350099.0</td>\n","      <td>Филевский парк</td>\n","      <td>Береговой проезд</td>\n","      <td>2</td>\n","      <td>Народное Ополчение</td>\n","      <td>Береговой-2</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>796</th>\n","      <td></td>\n","      <td></td>\n","      <td>https://www.cian.ru/sale/flat/305093267/</td>\n","      <td>Москва</td>\n","      <td>sale</td>\n","      <td>flat</td>\n","      <td>5</td>\n","      <td>14</td>\n","      <td>1</td>\n","      <td>34.30</td>\n","      <td>9078206.0</td>\n","      <td></td>\n","      <td>Аэростатная</td>\n","      <td>6к4</td>\n","      <td>Кокошкино</td>\n","      <td>Новое Внуково</td>\n","    </tr>\n","    <tr>\n","      <th>797</th>\n","      <td></td>\n","      <td></td>\n","      <td>https://www.cian.ru/sale/flat/302666659/</td>\n","      <td>Москва</td>\n","      <td>sale</td>\n","      <td>flat</td>\n","      <td>9</td>\n","      <td>10</td>\n","      <td>1</td>\n","      <td>38.79</td>\n","      <td>9007090.0</td>\n","      <td></td>\n","      <td></td>\n","      <td>к32</td>\n","      <td>Кокошкино</td>\n","      <td>Новое Внуково ЖК</td>\n","    </tr>\n","    <tr>\n","      <th>798</th>\n","      <td></td>\n","      <td></td>\n","      <td>https://www.cian.ru/sale/flat/302666665/</td>\n","      <td>Москва</td>\n","      <td>sale</td>\n","      <td>flat</td>\n","      <td>9</td>\n","      <td>10</td>\n","      <td>1</td>\n","      <td>38.09</td>\n","      <td>9082782.0</td>\n","      <td></td>\n","      <td></td>\n","      <td>к32</td>\n","      <td>Кокошкино</td>\n","      <td>Новое Внуково ЖК</td>\n","    </tr>\n","    <tr>\n","      <th>799</th>\n","      <td></td>\n","      <td></td>\n","      <td>https://www.cian.ru/sale/flat/302667378/</td>\n","      <td>Москва</td>\n","      <td>sale</td>\n","      <td>flat</td>\n","      <td>4</td>\n","      <td>9</td>\n","      <td>1</td>\n","      <td>41.47</td>\n","      <td>9031284.0</td>\n","      <td></td>\n","      <td></td>\n","      <td>к28</td>\n","      <td>Рассказовка</td>\n","      <td>Новое Внуково ЖК</td>\n","    </tr>\n","    <tr>\n","      <th>800</th>\n","      <td></td>\n","      <td></td>\n","      <td>https://www.cian.ru/sale/flat/302666963/</td>\n","      <td>Москва</td>\n","      <td>sale</td>\n","      <td>flat</td>\n","      <td>2</td>\n","      <td>10</td>\n","      <td>1</td>\n","      <td>34.36</td>\n","      <td>9062840.0</td>\n","      <td></td>\n","      <td></td>\n","      <td>к21</td>\n","      <td>Санино</td>\n","      <td>Новое Внуково ЖК</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>801 rows × 16 columns</p>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-fb4830c3-bc9e-4e9b-83b0-9dc56e60b532')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-fb4830c3-bc9e-4e9b-83b0-9dc56e60b532 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-fb4830c3-bc9e-4e9b-83b0-9dc56e60b532');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-d38637b7-b3c0-4ef8-8f10-36780ebe4308\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-d38637b7-b3c0-4ef8-8f10-36780ebe4308')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-d38637b7-b3c0-4ef8-8f10-36780ebe4308 button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","summary":"{\n  \"name\": \"pd\",\n  \"rows\": 801,\n  \"fields\": [\n    {\n      \"column\": \"author\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 141,\n        \"samples\": [\n          \"\\u041c\\u0435\\u0441\\u0442\\u043e\",\n          \"ID 12536379\",\n          \"Kalinka Group\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"author_type\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 7,\n        \"samples\": [\n          \"developer\",\n          \"homeowner\",\n          \"unknown\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"url\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 801,\n        \"samples\": [\n          \"https://www.cian.ru/sale/flat/304391197/\",\n          \"https://www.cian.ru/sale/flat/293999191/\",\n          \"https://www.cian.ru/sale/flat/304177736/\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"location\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 1,\n        \"samples\": [\n          \"\\u041c\\u043e\\u0441\\u043a\\u0432\\u0430\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"deal_type\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 1,\n        \"samples\": [\n          \"sale\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"accommodation_type\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 1,\n        \"samples\": [\n          \"flat\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"floor\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 8,\n        \"min\": 1,\n        \"max\": 67,\n        \"num_unique_values\": 47,\n        \"samples\": [\n          32\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"floors_count\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 12,\n        \"min\": 3,\n        \"max\": 85,\n        \"num_unique_values\": 59,\n        \"samples\": [\n          21\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"rooms_count\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 0,\n        \"min\": 1,\n        \"max\": 2,\n        \"num_unique_values\": 2,\n        \"samples\": [\n          1\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"total_meters\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 17.894356733656586,\n        \"min\": 19.9,\n        \"max\": 178.6,\n        \"num_unique_values\": 478,\n        \"samples\": [\n          38.62\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"price\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 30061571.70919583,\n        \"min\": 5334200.0,\n        \"max\": 311598950.0,\n        \"num_unique_values\": 720,\n        \"samples\": [\n          16073181.0\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"district\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 70,\n        \"samples\": [\n          \"\\u042e\\u0436\\u043d\\u043e\\u043f\\u043e\\u0440\\u0442\\u043e\\u0432\\u044b\\u0439\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"street\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 153,\n        \"samples\": [\n          \"\\u043c. \\u0412\\u043e\\u043b\\u0433\\u043e\\u0433\\u0440\\u0430\\u0434\\u0441\\u043a\\u0438\\u0439 \\u043f\\u0440\\u043e\\u0441\\u043f\\u0435\\u043a\\u0442\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"house_number\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 215,\n        \"samples\": [\n          \"\\u043a23\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"underground\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 145,\n        \"samples\": [\n          \"\\u0423\\u0433\\u0440\\u0435\\u0448\\u0441\\u043a\\u0430\\u044f\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"residential_complex\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 231,\n        \"samples\": [\n          \"\\u042d\\u043a\\u043e \\u0411\\u0443\\u043d\\u0438\\u043d\\u043e \\u0416\\u041a\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}"}},"metadata":{},"execution_count":34}]},{"cell_type":"code","source":["#Сохраняем в xls\n","df.to_excel('newhouse.xlsx', index=False)"],"metadata":{"id":"E2-8cF0HUTz0","executionInfo":{"status":"ok","timestamp":1721921731693,"user_tz":-180,"elapsed":712,"user":{"displayName":"Алена Щелкунова","userId":"02876905872959079261"}}},"execution_count":35,"outputs":[]},{"cell_type":"code","source":["#Сохраняем в pickle\n","df.to_pickle('newhouse.pkl')"],"metadata":{"id":"mdy3r6hpVXLd","executionInfo":{"status":"ok","timestamp":1721921733404,"user_tz":-180,"elapsed":3,"user":{"displayName":"Алена Щелкунова","userId":"02876905872959079261"}}},"execution_count":36,"outputs":[]},{"cell_type":"code","source":["import pandas as pd\n","import sqlite3\n","\n","conn = sqlite3.connect(\"newhouse_database\")"],"metadata":{"id":"Kcd1Sv-JWvDM","executionInfo":{"status":"ok","timestamp":1721921735942,"user_tz":-180,"elapsed":293,"user":{"displayName":"Алена Щелкунова","userId":"02876905872959079261"}}},"execution_count":37,"outputs":[]},{"cell_type":"code","source":["data = {\n","\n","       'author':['А101','ПИК','Апрелевка С2','Главстрой','Апрелевка С2'],\n","        'author_type':['developer','developer','developer','developer','developer'],\n","       'location':['Москва','Москва','Москва','Москва','Москва']\n","}\n","\n","df = pd.DataFrame(data)"],"metadata":{"id":"qVZKP_bFXrQm","executionInfo":{"status":"ok","timestamp":1721921738547,"user_tz":-180,"elapsed":399,"user":{"displayName":"Алена Щелкунова","userId":"02876905872959079261"}}},"execution_count":38,"outputs":[]},{"cell_type":"code","source":["\n","df"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"id":"gXLLcr4CYha8","executionInfo":{"status":"ok","timestamp":1721921742345,"user_tz":-180,"elapsed":571,"user":{"displayName":"Алена Щелкунова","userId":"02876905872959079261"}},"outputId":"80c5d7b1-cc2c-4df0-a0d8-3c6aff7d457e"},"execution_count":39,"outputs":[{"output_type":"execute_result","data":{"text/plain":["         author author_type location\n","0          А101   developer   Москва\n","1           ПИК   developer   Москва\n","2  Апрелевка С2   developer   Москва\n","3     Главстрой   developer   Москва\n","4  Апрелевка С2   developer   Москва"],"text/html":["\n","  <div id=\"df-90846206-95e0-4056-b82b-6d44dead10b0\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>author</th>\n","      <th>author_type</th>\n","      <th>location</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>А101</td>\n","      <td>developer</td>\n","      <td>Москва</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>ПИК</td>\n","      <td>developer</td>\n","      <td>Москва</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>Апрелевка С2</td>\n","      <td>developer</td>\n","      <td>Москва</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>Главстрой</td>\n","      <td>developer</td>\n","      <td>Москва</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>Апрелевка С2</td>\n","      <td>developer</td>\n","      <td>Москва</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-90846206-95e0-4056-b82b-6d44dead10b0')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-90846206-95e0-4056-b82b-6d44dead10b0 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-90846206-95e0-4056-b82b-6d44dead10b0');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-95d5e622-cc0a-4858-b996-a9a5edfff032\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-95d5e622-cc0a-4858-b996-a9a5edfff032')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-95d5e622-cc0a-4858-b996-a9a5edfff032 button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","variable_name":"df","summary":"{\n  \"name\": \"df\",\n  \"rows\": 5,\n  \"fields\": [\n    {\n      \"column\": \"author\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 4,\n        \"samples\": [\n          \"\\u041f\\u0418\\u041a\",\n          \"\\u0413\\u043b\\u0430\\u0432\\u0441\\u0442\\u0440\\u043e\\u0439\",\n          \"\\u0410101\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"author_type\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 1,\n        \"samples\": [\n          \"developer\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"location\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 1,\n        \"samples\": [\n          \"\\u041c\\u043e\\u0441\\u043a\\u0432\\u0430\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}"}},"metadata":{},"execution_count":39}]}],"metadata":{"colab":{"provenance":[{"file_id":"1JxL5oAPU5KqgVPxvYoglLjUj-1U0P_ku","timestamp":1721921908885}],"mount_file_id":"1JxL5oAPU5KqgVPxvYoglLjUj-1U0P_ku","authorship_tag":"ABX9TyOnsUTzFyDE4bH0W6KRHgYT"},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}